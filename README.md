# Carton PS5 eFootball Cup

ูุฏุฑ ุชูุฑูููุช ุจุฑุง ุจุงุฒ **eFootball (PS5)** ุจุง ุชูุฑฺฉุฒ ุจุฑ ุฒุจุงู ูุงุฑุณ ู ฺุฏูุงู **RTL**.
ุงูฺฉุงูุงุช ุงุตู ุดุงูู: ุงุฌุงุฏ ู ูุฏุฑุช ฺฏุฑููโูุงุ ุจุฑูุงูู ุจุงุฒโูุงุ ุซุจุช ูุชุงุฌุ ูุญุงุณุจู ุฑุฏูโุจูุฏุ ูุฏุฑุช ุจุงุฒฺฉูโูุงุ **ฺฏุฒุงุฑุดโ/ุฎุจุฑ** ุจุง ูุฏุงุ ูุงฺฉ/ูุธุฑุ ู **ูพูู ูุฑุงุด/ุญุฐู ููุท ุจุฑุง ูุฏุฑ**.

> Tech: **Next.js 15** ยท **Prisma** ยท **SQLite** (ูพุดโูุฑุถ) ยท **TailwindCSS** ยท (ุงุฎุชุงุฑ) **shadcn/ui** ยท Persian RTL

---

## โจ ุงูฺฉุงูุงุช

* **ุจุงุฒฺฉูโูุง**: ุณุงุฎุช/ูุฑุงุด/ุญุฐูุ ูุณุชโุจูุฏุ ุฌุณุชโูุฌู
* **ุจุงุฒโูุง (Matches)**: ุซุจุช ูุฒุจุงู/ูููุงูุ ููุชูุ ูุชุฌูุ ุฒูุงู ุดุฑูุนุ ูุถุนุช (SCHEDULED/DONE)ุ ูุฑุงุด/ุญุฐู (ููุท ูุฏุฑ)
* **ุจุฑูุงูู ุจุงุฒโูุง (Fixtures)**: ููุงุด ฺฏุฑููโุจูโฺฏุฑูู + **ุชุงุฑุฎ ุดูุณ** + ูุชุฌู
* **ฺฏุฑููโูุง (Groups)**: ูุณุชุ ุจุฑูุงูู ู ูุชุงุฌ ูุฑ ฺฏุฑูู
* **ฺฏุฒุงุฑุดโูุง (Reports)**: ุงุฌุงุฏ ุฎุจุฑ/ฺฏุฒุงุฑุด ุจุง **ุขูพููุฏ ุชุตูุฑ/ูุฏู**ุ ุขุฏุฑุณโุฎูุงู (slug) ูุงุฑุณุ ููุงุด ูุงฺฉ/ูุธุฑ
* **ุงุญุฑุงุฒ ููุช ุณุจฺฉ**: ูุฑูุฏ/ุฎุฑูุฌุ ููุงุด ุฏฺฉููโูุง ูุฏุฑุช ููุท ุจุฑุง ฺฉุงุฑุจุฑ ูุงุฑุฏุดุฏู
* **ุฒุจุงู ูุงุฑุณ & RTL**: ูููุช/ุฑุงุณุชโฺูุ ูุงูุจโุจูุฏ ุชุงุฑุฎ ุดูุณ (`faDateTime`)
* **Server Actions** ู Route Handlers ุฏุฑ Next.js 15
* ุจูููโุณุงุฒ ุฑูุฑุด ุจุง `dynamic = "force-dynamic"` ุฏุฑ ุตูุญุงุช ฺฉู ุฏุงุฏู ุฒูุฏู ุฏุงุฑูุฏ

---

## ๐งฑ ูุนูุงุฑ ู ุณุงุฎุชุงุฑ ูพูุดูโูุง

```
web/
โโ src/
โ  โโ app/
โ  โ  โโ admin/                 # ูุฑูุฏโูุง ูุฏุฑุช (ุงุฎุชุงุฑ)
โ  โ  โโ api/
โ  โ  โ  โโ upload/route.ts     # ุขูพููุฏ ูุงู โ ุจุฑูโฺฏุฑุฏุงูุฏ { url }
โ  โ  โโ fixtures/page.tsx      # ุจุฑูุงูู ุจุงุฒโูุง + ุชุงุฑุฎ ุดูุณ
โ  โ  โโ groups/page.tsx        # ุฌุฏูู ฺฏุฑููโูุง
โ  โ  โโ login/page.tsx         # ูุฑูุฏ
โ  โ  โโ logout/page.tsx        # ุฎุฑูุฌ
โ  โ  โโ matches/
โ  โ  โ  โโ page.tsx            # ูุณุช ุจุงุฒโูุง
โ  โ  โ  โโ [id]/edit/page.tsx  # ูุฑุงุด/ุญุฐู ุจุงุฒ (ูุฏุฑ)
โ  โ  โโ players/
โ  โ  โ  โโ page.tsx            # ูุณุช ุจุงุฒฺฉูโูุง (+ ุฏฺฉูู ูุฑุงุด ุจุฑุง ูุฏุฑ)
โ  โ  โ  โโ new/page.tsx        # ุณุงุฎุช ุจุงุฒฺฉู
โ  โ  โ  โโ [id]/edit/page.tsx  # ูุฑุงุด/ุญุฐู ุจุงุฒฺฉู
โ  โ  โโ reports/
โ  โ  โ  โโ page.tsx            # ูุณุช ฺฏุฒุงุฑุดโูุง
โ  โ  โ  โโ new/page.tsx        # ุณุงุฎุช ฺฏุฒุงุฑุด + ุขูพููุฏ ูุฏุง
โ  โ  โ  โโ [slug]/page.tsx     # ููุงุด ฺฏุฒุงุฑุด + ูุงฺฉ/ูุธุฑ
โ  โ  โโ page.tsx               # ุฎุงูู
โ  โโ components/               # NavClient ู ุงุฌุฒุง UI
โ  โโ lib/
โ  โ  โโ auth.ts                # ฺฉูฺฉ/ุชูฺฉู ู ฺฉูฺฉโูุชุฏ requireUser
โ  โ  โโ db.ts                  # Prisma Client
โ  โ  โโ date.ts                # faDateTime, faDate
โ  โ  โโ prisma-helpers.ts      # ูพุงุฑุณุฑูุง ุนุฏุฏ/ุชุงุฑุฎ (intOrNull, dateOrNull,โฆ)
โ  โโ styles/                   # Tailwind, globals
โโ prisma/
โ  โโ schema.prisma
โ  โโ migrations/               # ููุงุฌุฑุชโูุง
โโ public/
   โโ uploads/YYYY-MM-DD/       # ูุงูโูุง ุขูพููุฏุดุฏู
```

---

## ๐๏ธ ูุฏูโูุง ุฏุงุฏู (ุฎูุงุตู)

> ูุงู ฺฉุงูู: `prisma/schema.prisma`

* **Player**: `id, fullName, dept?, groupId`
* **Group**: `id, name, โฆ`
* **Match**:
  `id, groupId, homeId, awayId, week?, kickoffAt?, homeScore?, awayScore?, status(enum)`
* **Report**: `id, slug, title, summary?, content?, likesCount, commentsCount, medias[]`
* **Media**: `id, reportId, url, type(IMAGE|VIDEO)`
* **Comment**: `id, reportId, author?, content, approved`
* (ุจูโุฑูุฒุฑุณุงู ุดุฏู) **Cascade** ุญุฐู ูุฏุง/ฺฉุงููุช ููฺฏุงู ุญุฐู ฺฏุฒุงุฑุด

---

## ๐ง ุฑุงูโุงูุฏุงุฒ ุณุฑุน

### 1) ูพุดโูุงุฒูุง

* Node.js 18+
* pnpm ุง npm/yarn
* (ูพุดโูุฑุถ) SQLite โ ูุงุจูโุชุนูุถ ุจุง Postgres/MySQL

### 2) ฺฉููู ู ูุตุจ

```bash
git clone https://github.com/setarehHosseinNet/carton-ps5-efootball-cup.git
cd carton-ps5-efootball-cup/web
pnpm install
```

### 3) ุชูุธู ูุชุบุฑูุง ูุญุท (`.env`)

ููููู:

```env
# Prisma
DATABASE_URL="file:./dev.db"

# Auth (ููููู)
AUTH_SECRET="a-very-strong-secret"

# ูุณุฑ ุขูพููุฏูุง (ุงุฎุชุงุฑ)
UPLOAD_DIR="public/uploads"
MAX_UPLOAD_MB=10
```

### 4) ุฏุชุงุจุณ

```bash
pnpm prisma migrate dev --name init
# (ุงุฎุชุงุฑ) ุงฺฏุฑ ุงุณฺฉุฑูพุช seed ุฏุงุฑุฏ:
pnpm prisma db seed
```

### 5) ุงุฌุฑุง

```bash
pnpm dev
# http://localhost:3000
```

### 6) ุณุงุฎุช ู ุงุฌุฑุง ุฏุฑ ุชููุฏ

```bash
pnpm build
pnpm start
```

---

## ๐ ุงุญุฑุงุฒ ููุช / ููุดโูุง

* **ฺฉุงุฑุจุฑ ูุงุฑุฏ ูุดุฏู**: ููุท ูุดุงูุฏู (ุจุงุฒฺฉูโูุงุ ุจุฑูุงููุ ฺฏุฑููโูุงุ ฺฏุฒุงุฑุดโูุง)
* **ูุฏุฑ (ูุงุฑุฏ ุดุฏู)**: ุฏฺฉููโูุง ยซูุฑุงุด/ุญุฐู/ุงุฌุงุฏยป ุฑุง ูโุจูุฏ ู ูโุชูุงูุฏ:

  * `/players/new`, `/players/[id]/edit`
  * `/matches/[id]/edit`
  * `/reports/new`, ู ุญุฐู/ูุฑุงุด ฺฏุฒุงุฑุดโูุง (ุฏุฑ ุตูุญูโ ฺฏุฒุงุฑุด)
* ฺฉูุชุฑู ุฏุณุชุฑุณ ุจุง ูููพุฑูุง `getSessionUser()` ู `requireUser()` (ุฏุฑ `lib/auth.ts`) ุงูุฌุงู ูโุดูุฏ.

---

## ๐ผ๏ธ ุขูพููุฏ ูุงู

* Route: `POST /api/upload`
* ูุฑูุฏ: `FormData` ุจุง ููุฏ `file`
* ุฎุฑูุฌ: `{ url: string }`
* ูุงูโูุง ุฏุฑ `public/uploads/YYYY-MM-DD/` ุฐุฎุฑู ูโุดููุฏ.
* ุฏุฑ ุณุงุฎุช ฺฏุฒุงุฑุดุ ุงุจุชุฏุง ูุงูโูุง ุขูพููุฏ ู URLูุง ุฐุฎุฑู ูโุดููุฏุ ุณูพุณ ฺฏุฒุงุฑุด ุจุง ุขุฑุงู `mediaUrls[]` ุงุฌุงุฏ ูโุดูุฏ.

> **ูฺฉุชู:** ุฏุฑ ููุฏูุฒ ุงฺฏุฑ ุฎุทุงูุง ูุฑุจูุท ุจู `pagefile.sys` ุง `DumpStack.log.tmp` ุฏุฏุฏุ ูุฑุจูุท ุจู Watchpack ุงุณุช ู ุงุฑุชุจุงุท ุจุง ูพุฑูฺู ูุฏุงุฑุฏ.

---

## ๐ ุตูุญุงุช ู ูุณุฑูุง

| ูุณุฑ                 | ุฏุณุชุฑุณ | ุชูุถุญ                                          |
| -------------------- | ------ | ---------------------------------------------- |
| `/`                  | ุนููู  | ุฎุงูู                                           |
| `/players`           | ุนููู  | ูุณุช ุจุงุฒฺฉูโูุง (ุจุง ุฏฺฉูู ูุฑุงุด ุจุฑุง ูุฏุฑ)      |
| `/players/new`       | ูุฏุฑ   | ุณุงุฎุช ุจุงุฒฺฉู                                    |
| `/players/[id]/edit` | ูุฏุฑ   | ูุฑุงุด/ุญุฐู ุจุงุฒฺฉู                              |
| `/matches`           | ุนููู  | ูุณุช ุจุงุฒโูุง                                   |
| `/matches/[id]/edit` | ูุฏุฑ   | ูุฑุงุด/ุญุฐู ุจุงุฒ                                |
| `/fixtures`          | ุนููู  | ุจุฑูุงููโ ุจุงุฒโูุง ฺฏุฑููโุจูโฺฏุฑูู + **ุชุงุฑุฎ ุดูุณ** |
| `/groups`            | ุนููู  | ุฌุฏูู ฺฏุฑููโูุง                                   |
| `/reports`           | ุนููู  | ูุณุช ฺฏุฒุงุฑุดโูุง/ุงุฎุจุงุฑ                            |
| `/reports/new`       | ูุฏุฑ   | ุงุฌุงุฏ ฺฏุฒุงุฑุด + ุขูพููุฏ                            |
| `/reports/[slug]`    | ุนููู  | ุตูุญู ฺฏุฒุงุฑุด (ูุงฺฉ/ูุธุฑ + ูุฏุง)                   |
| `/login`, `/logout`  | ุนููู  | ูุฑูุฏ/ุฎุฑูุฌ                                      |

---

## ๐ง ูฺฉุงุช ูู ููู

* ุตูุญุงุช ุฏุงุฏูโูุญูุฑ ุจุง `export const dynamic = "force-dynamic"` ุชุนุฑู ุดุฏูโุงูุฏ ุชุง ุฏุงุฏู ููุดู ุชุงุฒู ุจุงุดุฏ.
* ุจุฑุง ููุฏุงุฑุฏู ูุฑูุฏโูุง ุงุฒ `defaultValue` ุงุณุชูุงุฏู ุดุฏู (ูู `value`) ุชุง ุจุง Server Components ุณุงุฒฺฏุงุฑ ุจุงุดุฏ.
* ุฏุฑ ูุฑูโูุงุ ุจู ุฌุง state-managementุ ุงุฒ **Server Actions** ุงุณุชูุงุฏู ุดุฏู ุงุณุช.
* ุฏุฑ TypeScript: ููุฏูุง ูุชุฌู ุจุงุฒโูุง **`homeScore`** ู **`awayScore`** ูุณุชูุฏ (ูู `gHome/gAway`).

---

## ๐ ูุดฺฉูุงุช ุฑุงุฌ

* **Module not found: './like.client'**
  ุงฺฏุฑ ูุงฺฉ/ฺฉุงููุช ฺฉูุงูุช ุฑุง ูุงุฒู ูุฏุงุฑุฏุ importูุง ุฑุง ุญุฐู ุง ฺฉุงููุช ฺฉูุฏ.
* **cookies was called outside a request scope**
  ุชุงุจุนโูุง Auth ุฑุง ููุท ุฏุงุฎู ูุณุฑูุง RSC/Route Handler ูุฑุงุฎูุงู ฺฉูุฏ ู ุงุฒ `dynamic = "force-dynamic"` ฺฉูฺฉ ุจฺฏุฑุฏ.
* **ุฎุทุง Watchpack ุฏุฑ ููุฏูุฒ**
  ูพุงูโูุง `EINVAL pagefile.sys` ุจโุฎุทุฑูุฏ ู ุจู File Watcher ูุฑุจูุทโุงูุฏ.

---

## ๐ฃ๏ธ ููุดู ุฑุงู (Roadmap)

* ูพูู ูุฏุฑุช ฺฉูพุงุฑฺู ุจุฑุง ููู ุนููุงุช
* ูุญุงุณุจู ุฑุฏูโุจูุฏ ุฒูุฏู ฺฏุฑููโูุง
* ููุชุฑ/ุฌุณุชโูุฌู ูพุดุฑูุชู
* ฺูุฏุฒุจุงููโุณุงุฒ (i18n)
* OAuth ู ููุดโูุง ฺูุฏฺฏุงูู ฺฉุงุฑุจุฑ

---

## ๐ ูุฌูุฒ

MIT โ ุขุฒุงุฏ ุจุฑุง ุงุณุชูุงุฏู/ุชูุณุนู.
ุงฺฏุฑ ุงุฒ ูพุฑูฺู ุงุณุชูุงุฏู ฺฉุฑุฏุฏุ ฺฉ โญ๏ธ ุจู ูุฎุฒู ุจุฏูุฏ!

---

## ๐ค ูุดุงุฑฺฉุช

ฑ) ููุฑฺฉ โ ฒ) ุจุฑูฺ `feat/your-feature` โ ณ) ฺฉุงูุชโูุง ูุนูโุฏุงุฑ โ ด) PR
ููุงูู ฺฉุงูุช:
`feat: ...`ุ `fix: ...`ุ `chore: ...`ุ `docs: ...`, `refactor: ...`

---

## โ๏ธ ุงุณฺฉุฑูพุชโูุง

```bash
pnpm dev         # ุงุฌุฑุง ุชูุณุนู
pnpm build       # ุณุงุฎุช ุชููุฏ
pnpm start       # ุงุฌุฑุง ุชููุฏ
pnpm prisma db push
pnpm prisma migrate dev --name <name>
pnpm prisma studio
```

---

ูุฑุฌุง ฺฏุฑ ฺฉุฑุฏุฏ ุง ุงุฏูโุง ุฏุงุดุชุฏุ ุงุดู ุจุงุฒ ฺฉูุฏ ๐
